generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  password    String
  firstName   String
  lastName    String
  phone       String?
  role        Role     @default(USER)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  pets        Pet[]
  bookings    Booking[]
  sales       Sale[]
  
  @@map("users")
}

model Pet {
  id          String   @id @default(cuid())
  name        String
  species     String
  breed       String?
  age         Int?
  weight      Float?
  specialNotes String?
  userId      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  bookings    Booking[]
  
  @@map("pets")
}

model Service {
  id          String   @id @default(cuid())
  name        String
  description String
  price       Float
  duration    Int      // in minutes
  category    String
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  bookings    Booking[]
  
  @@map("services")
}

model Booking {
  id          String   @id @default(cuid())
  petId       String
  serviceId   String
  userId      String
  date        DateTime
  status      BookingStatus @default(PENDING)
  totalPrice  Float
  notes       String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  pet         Pet      @relation(fields: [petId], references: [id], onDelete: Cascade)
  service     Service  @relation(fields: [serviceId], references: [id])
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@map("bookings")
}

model Product {
  id          String   @id @default(cuid())
  name        String
  description String
  price       Float
  stock       Int
  category    String
  image       String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  saleItems   SaleItem[]
  
  @@map("products")
}

model Sale {
  id          String   @id @default(cuid())
  userId      String
  totalAmount Float
  status      SaleStatus @default(PENDING)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  items       SaleItem[]
  
  @@map("sales")
}

model SaleItem {
  id          String   @id @default(cuid())
  saleId      String
  productId   String
  quantity    Int
  unitPrice   Float
  totalPrice  Float
  
  sale        Sale     @relation(fields: [saleId], references: [id], onDelete: Cascade)
  product     Product  @relation(fields: [productId], references: [id])
  
  @@map("sale_items")
}

enum Role {
  USER
  ADMIN
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum SaleStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}